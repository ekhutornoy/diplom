= nested_form_for @income, :class => 'bp' do |f|
  -if @income.errors.any?
    #error_explanation
      %h2= "#{pluralize(@income.errors.count, "error")} prohibited this income from being saved:"
      %ul
        - @income.errors.full_messages.each do |msg|
          %li= msg

  .field
    = f.label :date
    = f.date_select :date
  .field
    = f.label :department
    = collection_select :income, :department_id, @departments, :id, :name
  .field
    = f.label :supplier
    = f.text_field :supplier
  .field
    .fields_header
      %span
        %b Наименование
      %span
        %b Количество
      %span
        %b Цена
    = f.fields_for :income_items
    = f.link_to_add 'Добавить позицию', :income_items
  %br
  .actions
    = f.submit 'Сохранить'
    = link_to 'Отмена', incomes_path
